version: 0.1
component: build
timeoutInSeconds: 300
shell: bash

# Clona el código fuente y lo prepara para el siguiente stage
steps:
  - type: Command
    name: "Clone and prepare source"
    timeoutInSeconds: 60
    command: |
      echo "Repository cloned successfully by DevOps service"
      echo "Source code available for next stage"
      
      # Verificar que el código esté disponible
      ls -la
      
      # Verificar estructura del proyecto
      if [ -f "pom.xml" ]; then
        echo "✅ Maven project detected"
      fi
      
      if [ -d "src" ]; then
        echo "✅ Source code directory found"
      fi
      
      # Crear un archivo zip con todo el código fuente para pasarlo al siguiente stage
      echo "Preparing source code for next stage..."
      tar -czf source-code.tar.gz --exclude='.git' --exclude='target' .
      
      echo "Source code packaged successfully"
      ls -la source-code.tar.gz

outputArtifacts:
  - name: source-code
    type: BINARY
    location: source-code.tar.gz